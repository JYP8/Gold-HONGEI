<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gold Buddy - ‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏°‡∏ó‡∏≠‡∏á</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Kanit', sans-serif; background-color: #fdfaf0; }
        .gold-card { background: linear-gradient(135deg, #f6d365 0%, #fda085 100%); }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-5xl mx-auto">
        <header class="flex justify-between items-center mb-8">
            <h1 class="text-3xl font-bold text-yellow-700">üèÜ Gold Buddy</h1>
            <div class="text-right">
                <p class="text-sm text-gray-500">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ (‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì)</p>
                <p id="livePrice" class="text-xl font-bold text-yellow-600">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</p>
            </div>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div class="gold-card p-6 rounded-2xl text-white shadow-lg">
                <p class="opacity-80">‡∏ó‡∏≠‡∏á‡∏™‡∏∞‡∏™‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                <h2 id="totalWeight" class="text-4xl font-bold">0.00 ‡∏Å‡∏£‡∏±‡∏°</h2>
                <p id="totalValue" class="mt-2 text-sm italic">‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏¥‡∏ô: ‡∏ø0</p>
            </div>
            
            <div class="bg-white p-6 rounded-2xl shadow-sm border border-yellow-100">
                <p class="text-gray-500">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏°</p>
                <h2 id="goalProgressText" class="text-2xl font-bold text-gray-800">0 / 10 ‡∏ö‡∏≤‡∏ó‡∏ó‡∏≠‡∏á</h2>
                <div class="w-full bg-gray-200 rounded-full h-2.5 mt-4">
                    <div id="goalBar" class="bg-yellow-500 h-2.5 rounded-full" style="width: 0%"></div>
                </div>
            </div>

            <div class="bg-white p-6 rounded-2xl shadow-sm border border-yellow-100">
                <canvas id="miniChart"></canvas>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="bg-white p-6 rounded-2xl shadow-sm border">
                <h3 class="font-bold mb-4 text-gray-700">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏ó‡∏≠‡∏á</h3>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm text-gray-500">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠ (‡∏ö‡∏≤‡∏ó)</label>
                        <input type="number" id="inputAmount" class="w-full p-2 border rounded-lg focus:ring-yellow-500 outline-none" placeholder="‡πÄ‡∏ä‡πà‡∏ô 2000">
                    </div>
                    <div>
                        <label class="block text-sm text-gray-500">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á‡∏ö‡∏≤‡∏ó‡∏•‡∏∞ (‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠)</label>
                        <input type="number" id="inputRate" class="w-full p-2 border rounded-lg" placeholder="‡πÄ‡∏ä‡πà‡∏ô 42000">
                    </div>
                    <button onclick="addRecord()" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 rounded-lg transition">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
                </div>
            </div>

            <div class="lg:col-span-2 bg-white p-6 rounded-2xl shadow-sm border overflow-x-auto">
                <h3 class="font-bold mb-4 text-gray-700">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏°</h3>
                <table class="w-full text-left">
                    <thead>
                        <tr class="text-gray-400 border-b">
                            <th class="pb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                            <th class="pb-2">‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô</th>
                            <th class="pb-2">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ (‡∏Å‡∏£‡∏±‡∏°)</th>
                            <th class="pb-2">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                        </tr>
                    </thead>
                    <tbody id="recordTable" class="text-gray-600">
                        </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        let goldData = JSON.parse(localStorage.getItem('goldData')) || [];
        let goalAmount = 10; // ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏≤‡∏ó‡∏ó‡∏≠‡∏á
        let currentGoldPrice = 42000; // ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏ï‡πâ‡∏ô

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á (‡πÉ‡∏ô‡πÅ‡∏≠‡∏õ‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏∞‡πÉ‡∏ä‡πâ Fetch API)
        function fetchGoldPrice() {
            // ‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏ß‡πà‡∏≤‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏°‡∏≤‡πÑ‡∏î‡πâ 42000-43000
            currentGoldPrice = 42500; 
            document.getElementById('livePrice').innerText = `‡∏ø${currentGoldPrice.toLocaleString()}`;
            updateDashboard();
        }

        function addRecord() {
            const amount = parseFloat(document.getElementById('inputAmount').value);
            const rate = parseFloat(document.getElementById('inputRate').value);
            
            if (amount > 0 && rate > 0) {
                // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ó‡∏≠‡∏á (1 ‡∏ö‡∏≤‡∏ó‡∏ó‡∏≠‡∏á = 15.24 ‡∏Å‡∏£‡∏±‡∏°)
                const weightGrams = (amount / rate) * 15.24;
                const record = {
                    date: new Date().toLocaleDateString('th-TH'),
                    amount: amount,
                    rate: rate,
                    weight: weightGrams,
                    timestamp: new Date().getTime()
                };
                
                goldData.push(record);
                localStorage.setItem('goldData', JSON.stringify(goldData));
                updateDashboard();
                renderTable();
                
                document.getElementById('inputAmount').value = '';
                document.getElementById('inputRate').value = '';
            }
        }

        function deleteRecord(index) {
            goldData.splice(index, 1);
            localStorage.setItem('goldData', JSON.stringify(goldData));
            updateDashboard();
            renderTable();
        }

        function updateDashboard() {
            const totalWeight = goldData.reduce((sum, item) => sum + item.weight, 0);
            const totalValue = (totalWeight / 15.24) * currentGoldPrice;
            const weightInBaht = totalWeight / 15.24;

            document.getElementById('totalWeight').innerText = `${totalWeight.toFixed(4)} ‡∏Å‡∏£‡∏±‡∏°`;
            document.getElementById('totalValue').innerText = `‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: ‡∏ø${Math.round(totalValue).toLocaleString()}`;
            
            // Update Goal
            const progressPercent = Math.min((weightInBaht / goalAmount) * 100, 100);
            document.getElementById('goalBar').style.width = progressPercent + '%';
            document.getElementById('goalProgressText').innerText = `${weightInBaht.toFixed(2)} / ${goalAmount} ‡∏ö‡∏≤‡∏ó‡∏ó‡∏≠‡∏á`;
            
            updateChart();
        }

        function renderTable() {
            const tableBody = document.getElementById('recordTable');
            tableBody.innerHTML = goldData.map((item, index) => `
                <tr class="border-b">
                    <td class="py-3">${item.date}</td>
                    <td>‡∏ø${item.amount.toLocaleString()}</td>
                    <td class="font-bold text-yellow-600">${item.weight.toFixed(4)}</td>
                    <td><button onclick="deleteRecord(${index})" class="text-red-400 hover:text-red-600">‡∏•‡∏ö</button></td>
                </tr>
            `).join('');
        }

        let myChart;
        function updateChart() {
            const ctx = document.getElementById('miniChart').getContext('2d');
            const labels = goldData.map(d => d.date);
            const dataValues = goldData.map(d => d.weight);

            if (myChart) myChart.destroy();
            myChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ó‡∏≠‡∏á‡∏™‡∏∞‡∏™‡∏° (‡∏Å‡∏£‡∏±‡∏°)',
                        data: dataValues,
                        borderColor: '#fda085',
                        backgroundColor: 'rgba(253, 160, 133, 0.2)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    plugins: { legend: { display: false } },
                    scales: { y: { display: false }, x: { display: false } }
                }
            });
        }

        // Initial Load
        fetchGoldPrice();
        renderTable();
    </script>
</body>
</html>
